function UM_wall_img_upload(){jQuery(".ajax-upload-dragdrop").remove(),jQuery(".um-groups-insert-photo").each(function(){apu=jQuery(this);var e={key:"wall_img_upload",action:"um_imageupload",set_id:0,set_mode:"wall",timestamp:apu.data("timestamp"),_wpnonce:apu.data("nonce"),group_id:jQuery('input[name="group_id"]').val()};apu.uploadFile({url:wp.ajax.settings.url,method:"POST",multiple:!1,formData:e,fileName:"wall_img_upload",allowedTypes:apu.attr("data-allowed"),maxFileSize:9999999,dragDropStr:"",sizeErrorStr:apu.attr("data-size-err"),extErrorStr:apu.attr("data-ext-err"),maxFileCountErrorStr:"",maxFileCount:1,showDelete:!1,showAbort:!1,showDone:!1,showFileCounter:!1,showStatusAfterSuccess:!0,returnType:"json",onSubmit:function(e){apu.parents(".um-groups-widget").find(".um-error-block").remove(),apu.parents(".um-groups-widget").find(".um-groups-post").addClass("um-disabled"),apu.parents(".um-groups-widget").find(".um-groups-preview").hide(),apu.parents(".um-groups-widget").find(".um-groups-preview img").attr("src",""),apu.parents(".um-groups-widget").find(".um-groups-preview input[type=hidden]").val("")},onSuccess:function(e,t,o){apu.selectedFiles=0,t.status&&0==t.status?(apu.parents(".um-groups-widget").find(".um-groups-post").addClass("um-disabled"),apu.parents(".um-groups-widget").find(".um-groups-textarea-elem").attr("placeholder",jQuery(".um-groups-textarea-elem").attr("data-ph")),apu.parents(".um-groups-widget").find(".upload-statusbar").prev("div").append('<div class="um-error-block">'+t.error+"</div>"),apu.parents(".um-groups-widget").find(".upload-statusbar").remove()):(apu.parents(".um-groups-widget").find(".um-groups-post").removeClass("um-disabled"),apu.parents(".um-groups-widget").find(".um-groups-textarea-elem").attr("placeholder",jQuery(".um-groups-textarea-elem").attr("data-photoph")),apu.parents(".um-groups-widget").find(".upload-statusbar").remove(),jQuery.each(t.data,function(e,t){apu.parents(".um-groups-widget").find(".um-groups-preview").show(),apu.parents(".um-groups-widget").find(".um-groups-preview img").attr("src",t.url),apu.parents(".um-groups-widget").find('.um-groups-preview input[type=hidden][name="_post_img"]').val(t.file),apu.parents(".um-groups-widget").find('.um-groups-preview input[type=hidden][name="_post_img_url"]').val(t.url)}))},onError:function(e){console.log(e)}})})}function UM_wall_confirmbox_show(e,t,o){jQuery(".um-groups-confirm").is(":visible")||(jQuery(".um-groups-confirm-m").html(t),jQuery(".um-groups-confirm-o,.um-groups-confirm").show(),jQuery(".um-groups-confirm").find(".um-groups-confirm-btn").addClass(o).attr("data-post_id",e))}function UM_wall_confirmbox_hide(){jQuery(".um-groups-confirm-o,.um-groups-confirm").hide()}function UM_wall_confirmbox_mobile(){var e=jQuery(window).width();e<=500?(max_width=e,margin_left=0,left=0):(max_width="400px",margin_left="-200px",left="50%"),jQuery(".um-groups-confirm").css({top:(jQuery(window).height()-jQuery(".um-groups-confirm").height())/2+"px",width:max_width,"margin-left":margin_left,left:left})}Loadwall_ajax=!1,jQuery(window).scroll(function(){0<jQuery(".um-groups-wall").length&&jQuery(window).scrollTop()+jQuery(window).height()>=jQuery(".um-groups-wall").offset().top+jQuery(".um-groups-wall").height()&&0==Loadwall_ajax&&0==jQuery(".um-groups-wall").attr("data-single_post")&&(Loadwall_ajax=!0,jQuery(".um-groups-load:last").show(),user_id=jQuery(".um-groups-wall").attr("data-user_id"),user_wall=jQuery(".um-groups-wall").attr("data-user_wall"),hashtag=jQuery(".um-groups-wall").attr("data-hashtag"),core_page=jQuery(".um-groups-wall").attr("data-core_page"),group_id=jQuery('input[name="group_id"]').val(),show_pending=jQuery(".um-groups-wall").attr("data-show-pending"),jQuery.ajax({url:wp.ajax.settings.url,type:"post",data:{action:"um_groups_load_wall",offset:jQuery(".um-groups-widget:not(.um-groups-new-post):visible").length,user_id:user_id,user_wall:user_wall,hashtag:hashtag,core_page:core_page,group_id:group_id,show_pending:show_pending,nonce:um_scripts.nonce},success:function(e){jQuery(".um-groups-load").hide(),""==e?Loadwall_ajax=!0:(jQuery(".um-groups-wall").append(e),Loadwall_ajax=!1),void 0!==e.restricted&&(alert(e.restricted),window.location.reload()),void 0!==e.debug&&console.log(e.debug)},error:function(e){console.log("UM Groups Discussion Error",e)}}))});var getUrlParameter=function(e){var t,o,r=decodeURIComponent(window.location.search.substring(1)).split("&");for(o=0;o<r.length;o++)if((t=r[o].split("="))[0]===e)return void 0===t[1]||t[1]};function split(e){return e.split(" ")}function extractLast(e){return split(e).pop()}function UM_wall_autocomplete_start(){jQuery("textarea.um-groups-textarea-elem,textarea.um-groups-comment-textarea").each(function(){if(el=jQuery(this),void 0===jQuery.ui)return!1;el.autocomplete({minLength:1,source:function(e,t){"@"==extractLast(e.term).charAt(0)&&jQuery.getJSON(wp.ajax.settings.url+"?action=um_groups_get_user_suggestions&term="+extractLast(e.term)+"&nonce="+um_scripts.nonce,function(e){t(e)})},select:function(e,t){t.item.name=t.item.name.replace("<strong>",""),t.item.name=t.item.name.replace("</strong>","");var o=split(this.value);return o.pop(),o.push("@"+t.item.name),o.push(""),this.value=jQuery.trim(o.join(" ")),!1}}).data("ui-autocomplete")._renderItem=function(e,t){return jQuery("<li />").data("item.autocomplete",t).append(t.photo+t.name+"<span>@"+t.username+"</span>").appendTo(e)}})}jQuery(window).resize(function(){UM_wall_confirmbox_mobile()}),jQuery(document).ready(function(){jQuery("textarea.um-groups-textarea-elem").length&&UM_wall_autocomplete_start();var e=getUrlParameter("group_post"),t=getUrlParameter("wall_comment_id");0<e&&!t&&jQuery("body").scrollTo("#postid-"+parseInt(e),500,{offset:0,onAfter:function(){jQuery("#postid-"+parseInt(e)).addClass("highlighted")}}),0<e&&0<t&&jQuery("body").scrollTo("#commentid-"+parseInt(t),500,{offset:-10,onAfter:function(){jQuery("#commentid-"+parseInt(t)).addClass("highlighted")}}),jQuery(document).on("click",".um-groups-disp-comments",function(e){e.preventDefault();var t=jQuery(this).parents(".um-groups-widget").attr("id").replace("postid-","");return jQuery("body").scrollTo("#wallcomments-"+parseInt(t),{duration:200}),!1}),jQuery(document).on("click",".um-groups-confirm-removepost",function(e){e.preventDefault();var t=jQuery(this).attr("data-post_id");return jQuery(".um-groups-widget#postid-"+t).hide(),UM_wall_confirmbox_hide(),jQuery.ajax({url:wp.ajax.settings.url,type:"post",data:{action:"um_groups_remove_post",post_id:t,group_id:jQuery('input[name="group_id"]').val(),nonce:um_scripts.nonce},success:function(e){void 0!==e.restricted&&(alert(e.restricted),window.location.reload()),void 0!==e.debug&&console.log(e.debug)}}),!1}),jQuery(document).on("click",".um-groups-confirm-removecomment",function(e){e.preventDefault();var t=jQuery(this).attr("data-post_id");return jQuery(".um-groups-commentl#commentid-"+t).hide(),UM_wall_confirmbox_hide(),jQuery.ajax({url:wp.ajax.settings.url,type:"post",data:{action:"um_groups_remove_comment",comment_id:t,group_id:jQuery('input[name="group_id"]').val(),nonce:um_scripts.nonce},success:function(e){void 0!==e.restricted&&(alert(e.restricted),window.location.reload()),void 0!==e.debug&&console.log(e.debug)}}),!1}),jQuery(document).on("click",".um-groups-trash",function(e){e.preventDefault();var t=jQuery(this),o=t.parents(".um-groups-widget").attr("id").replace("postid-",""),r=t.attr("data-msg");return t.parents(".um-groups-dialog").hide(),UM_wall_confirmbox_show(o,r,"um-groups-confirm-removepost"),UM_wall_confirmbox_mobile(),!1}),jQuery(document).on("click",".um-groups-editc a.delete",function(e){e.preventDefault();var t=jQuery(this),o=t.parent().parent().parent().parent().parent().attr("id").replace("commentid-",""),r=t.attr("data-msg");return t.parents(".um-groups-dialog").hide(),UM_wall_confirmbox_show(o,r,"um-groups-confirm-removecomment"),UM_wall_confirmbox_mobile(),!1}),jQuery(document).on("click",".um-groups-editc a.edit",function(e){if(e.preventDefault(),!jQuery(this).parents(".um-groups-commentl").hasClass("unready")){0<jQuery(this).parents(".um-groups-comment-info").find(".um-groups-comment-area").length&&jQuery(this).parents(".um-groups-comment-info").find(".um-groups-comment-area").remove();var t=jQuery(this).parents(".um-groups-comments").find(".um-groups-comment-area:first"),o=jQuery(this).data("commentid"),r=t.clone();jQuery(this).parents(".um-groups-comment-info").find(".um-groups-editc-d").hide(),jQuery(this).parents(".um-groups-comment-info").find("div").hide(),jQuery("#commentid-"+o).addClass("editing"),r.css({paddingTop:0,paddingLeft:0}),r.find(".um-groups-comment-avatar").hide(),r.appendTo(jQuery(this).parents(".um-groups-comment-info")),r.find("textarea").attr("data-commentid",o).attr("placeholder",r.find("textarea").attr("data-replytext")).val(jQuery("#um-groups-reply-"+o).val()).focus(),UM_wall_autocomplete_start()}return!1}),jQuery(document).on("click",".um-groups-confirm-close,.um-groups-confirm-o",function(e){return e.preventDefault(),UM_wall_confirmbox_hide(),!1}),jQuery(document).on("click",".um-groups-modal-hide",function(e){return e.preventDefault(),remove_Modal(),!1}),jQuery(document).on("click",".um-groups-img-remove",function(e){el=jQuery(this).parents("form"),el.find("#_post_img").val(""),el.find(".um-groups-preview img").attr("src",""),el.find(".um-groups-preview").hide(),0==el.find("textarea:visible").val().trim().length&&el.find(".um-groups-post").addClass("um-disabled")}),UM_wall_img_upload(),jQuery(document).on("click",".um-groups-comment-hide",function(e){if(e.preventDefault(),el=jQuery(this),div=el.parent(),div.hasClass("editing"))div.find(".um-groups-comment-area").remove(),div.find(".um-groups-comment-info > div").show(),div.find(".um-groups-editc-d").hide(),div.removeClass("editing");else{var t=div.attr("id").replace("commentid-","");div.find(".um-groups-comment-info").hide(),div.find(".um-groups-comment-hidden").show(),div.find(".um-groups-comment-avatar").addClass("hidden-1"),el.remove(),jQuery.ajax({url:wp.ajax.settings.url,type:"post",data:{action:"um_groups_hide_comment",comment_id:t,group_id:jQuery('input[name="group_id"]').val(),nonce:um_scripts.nonce},success:function(e){void 0!==e.restricted&&(alert(e.restricted),window.location.reload()),void 0!==e.debug&&console.log(e.debug)}})}return!1}),jQuery(document).on("click",".um-groups-comment-hidden a",function(e){e.preventDefault(),el=jQuery(this);var t=el.parent().parent().attr("id").replace("commentid-","");return el.parent().parent().find(".um-groups-comment-info").show(),el.parent().parent().find(".um-groups-comment-hidden").hide(),el.parent().parent().find(".um-groups-comment-hide").show(),el.parent().parent().find(".um-groups-comment-avatar").removeClass("hidden-1"),el.parent().parent().prepend('<a href="#" class="um-groups-comment-hide um-tip-s"><i class="um-icon-close-round"></i></a>'),jQuery.ajax({url:wp.ajax.settings.url,type:"post",data:{action:"um_groups_unhide_comment",comment_id:t,group_id:jQuery('input[name="group_id"]').val(),nonce:um_scripts.nonce},success:function(e){void 0!==e.restricted&&(alert(e.restricted),window.location.reload()),void 0!==e.debug&&console.log(e.debug)}}),!1}),jQuery(document).on("click",".um-groups-show-likes",function(e){e.preventDefault(),el=jQuery(this);var t=el.attr("data-post_id");return parseInt(el.find(".um-groups-post-likes").html())<=0||(prepare_Modal(),jQuery.ajax({url:wp.ajax.settings.url,type:"post",data:{action:"um_groups_get_post_likes",post_id:t,group_id:jQuery('input[name="group_id"]').val(),nonce:um_scripts.nonce},success:function(e){e?(show_Modal(e),responsive_Modal()):remove_Modal(),void 0!==e.restricted&&(alert(e.restricted),window.location.reload()),void 0!==e.debug&&console.log(e.debug)}})),!1}),jQuery(document).on("click",".um-groups-comment-likes",function(e){e.preventDefault(),el=jQuery(this);var t=el.parent().parent().parent().attr("id").replace("commentid-","");return prepare_Modal(),jQuery.ajax({url:wp.ajax.settings.url,type:"post",data:{action:"um_groups_get_comment_likes",comment_id:t,group_id:jQuery('input[name="group_id"]').val(),nonce:um_scripts.nonce},success:function(e){e?(show_Modal(e),responsive_Modal()):remove_Modal(),void 0!==e.restricted&&(alert(e.restricted),window.location.reload()),void 0!==e.debug&&console.log(e.debug)}}),!1}),jQuery(document).on("mouseover",".um-groups-commentl",function(e){jQuery(this).find(".um-groups-comment-hide").show()}),jQuery(document).on("mouseout",".um-groups-commentl",function(e){jQuery(this).find(".um-groups-comment-hide").hide()}),jQuery(document).on("click",".um-groups-report:not(.flagged)",function(e){var t=jQuery(this),o=t.parents(".um-groups-widget").attr("id").replace("postid-","");jQuery.ajax({url:wp.ajax.settings.url,type:"post",data:{action:"um_groups_report_post",post_id:o,group_id:jQuery('input[name="group_id"]').val(),nonce:um_scripts.nonce},success:function(e){t.addClass("flagged").html(t.attr("data-cancel_report")),void 0!==e.restricted&&(alert(e.restricted),window.location.reload()),void 0!==e.debug&&console.log(e.debug)}})}),jQuery(document).on("click",".um-groups-report.flagged",function(e){var t=jQuery(this),o=t.parents(".um-groups-widget").attr("id").replace("postid-","");jQuery.ajax({url:wp.ajax.settings.url,type:"post",data:{action:"um_groups_unreport_post",post_id:o,group_id:jQuery('input[name="group_id"]').val(),nonce:um_scripts.nonce},success:function(e){t.removeClass("flagged").html(t.attr("data-report")),void 0!==e.restricted&&(alert(e.restricted),window.location.reload()),void 0!==e.debug&&console.log(e.debug)}})}),jQuery(document).on("click",".um-groups-commentload",function(e){e.preventDefault();var t=jQuery(this);t.hide(),t.parent().find(".um-groups-commentload-spin").show();var o=t.attr("data-loaded"),r=t.parents(".um-groups-widget").attr("id").replace("postid-","");return t.parents(".um-groups-comments").find(".um-groups-commentload-end").remove(),jQuery.ajax({url:wp.ajax.settings.url,type:"post",data:{action:"um_groups_load_more_comments",post_id:r,offset:o,group_id:jQuery('input[name="group_id"]').val(),nonce:um_scripts.nonce},success:function(e){t.before(e),t.attr("data-loaded",t.parents(".um-groups-comments").find(".um-groups-commentl:not(.is-child):not(.um-groups-comment-area):visible").length),t.parent().find(".um-groups-commentload-spin").hide(),t.parents(".um-groups-comments").find(".um-groups-commentload-end").length&&t.show().find("span").html(t.attr("data-load_comments")),void 0!==e.restricted&&(alert(e.restricted),window.location.reload()),void 0!==e.debug&&console.log(e.debug)}}),!1}),jQuery(document).on("click",".um-groups-ccommentload",function(e){e.preventDefault();var t=jQuery(this);t.hide(),t.parent().find(".um-groups-ccommentload-spin").show();var o=t.attr("data-loaded"),r=t.parents(".um-groups-widget").attr("id").replace("postid-",""),u=t.parents(".um-groups-commentwrap").attr("data-comment_id");return t.parents(".um-groups-comments").find(".um-groups-ccommentload-end").remove(),jQuery.ajax({url:wp.ajax.settings.url,type:"post",data:{action:"um_groups_load_more_replies",post_id:r,comment_id:u,offset:o,group_id:jQuery('input[name="group_id"]').val(),nonce:um_scripts.nonce},success:function(e){t.before(e),t.attr("data-loaded",t.parents(".um-groups-commentwrap").find(".um-groups-commentl.is-child:not(.um-groups-comment-area):visible").length),t.parent().find(".um-groups-ccommentload-spin").hide(),t.parents(".um-groups-commentwrap").find(".um-groups-ccommentload-end").length&&t.show().find("span").html(t.attr("data-load_replies")),void 0!==e.restricted&&(alert(e.restricted),window.location.reload()),void 0!==e.debug&&console.log(e.debug)}}),!1}),jQuery(document).on("click",".um-groups-post",function(e){return e.preventDefault(),jQuery(this).hasClass("um-disabled")||jQuery(this).parents(".um-groups-widget").find(".um-groups-publish").submit(),!1}),jQuery(document).on("input properychange",".um-groups-textarea-elem",function(){0<jQuery(this).val().trim().length?jQuery(this).parents(".um-groups-widget").find(".um-groups-post").removeClass("um-disabled"):jQuery(this).parents(".um-groups-widget").find(".um-groups-post").addClass("um-disabled")}),jQuery(document).on("click",".um-groups-comment-reply",function(e){if(e.preventDefault(),!jQuery(this).parents(".um-groups-commentl").hasClass("unready"))if(0==jQuery(this).parents(".um-groups-comment-info").find(".um-groups-comment-area").length){var t=jQuery(this).parents(".um-groups-comments").find(".um-groups-comment-area:first").clone();t.appendTo(jQuery(this).parents(".um-groups-comment-info")),t.find("textarea").attr("data-reply_to",jQuery(this).attr("data-commentid")).attr("placeholder",t.find("textarea").attr("data-replytext")).focus(),UM_wall_autocomplete_start()}else jQuery(this).parents(".um-groups-comment-info").find(".um-groups-comment-area").remove();return!1}),jQuery(document).on("keypress",".um-groups-comment-textarea",function(e){if((10==e.keyCode||13==e.keyCode)&&!e.shiftKey&&0<jQuery(this).val().trim().length){e.preventDefault();var u=jQuery(this),t=u.data("commentid"),n=u.val(),o=u.parents(".um-groups-widget").attr("id").replace("postid-",""),r=jQuery("#commentid-"+t);if(t&&r.length&&r.hasClass("editing"))jQuery.ajax({url:wp.ajax.settings.url,type:"post",dataType:"json",data:{action:"um_groups_wall_comment",postid:o,commentid:t,comment:n,group_id:jQuery('input[name="group_id"]').val(),nonce:um_scripts.nonce},success:function(e){r.find("#um-groups-reply-"+t).val(n),r.find(".um-groups-comment-text").html(e.comment_content),r.find(".um-groups-editc-d").hide(),r.find(".um-groups-comment-area").remove(),r.find(".um-groups-comment-info > div").show(),r.removeClass("editing"),r.find(".um-groups-commentl.um-groups-comment-area").show(),void 0!==e.restricted&&(alert(e.restricted),window.location.reload()),void 0!==e.debug&&console.log(e.debug)}});else{var i=u.parents(".um-groups-comments"),a=u.attr("data-reply_to");u.val("");var s=u.parents(".um-groups-widget").find(".um-groups-post-comments");s.html(parseInt(s.html())+1);var d=i.find(".um-groups-commentload");i.find(".um-groups-commentload").remove();var m=i.find(".um-groups-commentload-spin");i.find(".um-groups-commentload-spin").remove();var p=i.find(".um-groups-commentwrap-clone"),l=u.parents(".um-groups-commentwrap").find(".um-groups-comment-child");if(cchild_clone=l.clone(),0<a){var c=(g=i.find(".um-groups-commentlre-clone:first")).clone();u.parents(".um-groups-commentwrap").find(".um-groups-comment-child").length&&(0<l.find(".um-groups-ccommentload").length?(c.addClass("unready"),c.insertBefore(l.find(".um-groups-ccommentload")),c.find(".um-groups-comment-text").text(n)):c.addClass("unready").appendTo(l).fadeIn().find(".um-groups-comment-text").text(n))}else{var g=i.find(".um-groups-commentl-clone:first");(c=g.clone()).addClass("unready").appendTo(i.find(".um-groups-comments-loop")).fadeIn().find(".um-groups-comment-text").text(n)}d.appendTo(i.find(".um-groups-comments-loop")),m.appendTo(i.find(".um-groups-comments-loop")),jQuery.ajax({url:wp.ajax.settings.url,type:"post",dataType:"json",data:{action:"um_groups_wall_comment",postid:o,reply_to:a,comment:n,group_id:jQuery('input[name="group_id"]').val(),nonce:um_scripts.nonce},success:function(e){if(c.attr("id","commentid-"+e.commentid).removeClass("um-groups-commentl-clone"),c.find(".original-content").attr("id","um-groups-reply-"+e.commentid).val(n),c.find(".um-groups-editc-d .edit").data("commentid",e.commentid),c.find(".um-groups-comment-reply").length){c.find(".um-groups-comment-reply").attr("data-commentid",e.commentid),jQuery("#commentid-"+e.commentid+" .um-groups-comment-text").html(e.comment_content);var t=jQuery("#commentid-"+e.commentid).clone();jQuery("#commentid-"+e.commentid).remove(),(r=p.clone()).removeClass("um-groups-commentwrap-clone"),r.addClass("um-groups-commentwrap"),r.attr("data-comment_id",e.commentid),t.removeClass("unready"),a<=0&&(t.appendTo(r),r.appendTo(i.find(".um-groups-comments-loop")))}if(c.removeClass("unready"),0<a){var o=u.parents(".um-groups-commentwrap").find(".um-groups-comment-child"),r=u.parents(".um-groups-commentwrap");u.parents(".um-groups-commentwrap").find(".um-groups-comment-child").remove(),cchild_clone=o.clone(),cchild_clone.appendTo(r).fadeIn()}jQuery("#commentid-"+e.commentid).fadeTo(1e3,1),void 0!==e.restricted&&(alert(e.restricted),window.location.reload()),void 0!==e.debug&&console.log(e.debug)}})}}else if((10==e.keyCode||13==e.keyCode)&&!e.shiftKey)return e.preventDefault(),!1}),jQuery(document).on("click",".um-groups-dialog a",function(e){return e.preventDefault(),e.stopPropagation(),!1}),jQuery(document).on("click",".um-groups-start-dialog",function(e){if(e.stopPropagation(),e.preventDefault(),!jQuery(this).parents(".um-groups-widget").hasClass("unready")){var t=jQuery(this).parent().find("."+jQuery(this).attr("data-role"));t.is(":visible")?t.hide():t.show()}return!1}),jQuery(document).on("click",".um-groups-editc a",function(e){e.stopPropagation(),e.preventDefault(),jQuery(".um-groups-comment-meta").find(".um-groups-editc-d:visible").hide();var t=jQuery(this).parents(".um-groups-comment-meta").find(".um-groups-editc-d");return t.is(":visible")?t.hide():t.show(),!1}),jQuery(document).click(function(){jQuery(".um-groups-dialog").hide(),jQuery(".um-groups-comment-meta").find(".um-groups-editc-d:visible").hide()}),jQuery(document).on("click",".um-groups-comment a",function(e){return e.preventDefault(),jQuery(this).parents(".um-groups-widget").hasClass("unready")||jQuery(this).parents(".um-groups-widget").find(".um-groups-comments .um-groups-comment-box textarea").focus(),!1}),jQuery(document).on("click",".um-groups-comment-like:not(.active)",function(e){if(e.preventDefault(),!jQuery(this).parents(".um-groups-commentl").hasClass("unready")){var t=jQuery(this).parents(".um-groups-commentl").attr("id").replace("commentid-",""),o=jQuery(this).parents(".um-groups-commentl").find(".um-groups-ajaxdata-commentlikes"),r=parseInt(o.html())+1;o.html(r),jQuery(this).parents(".um-groups-commentl").find(".um-groups-comment-likes").removeClass().addClass("um-groups-comment-likes").addClass("count-"+r),jQuery(this).addClass("active"),jQuery(this).html(jQuery(this).attr("data-unlike_text")),jQuery.ajax({url:wp.ajax.settings.url,type:"post",dataType:"json",data:{action:"um_groups_like_comment",commentid:t,group_id:jQuery('input[name="group_id"]').val(),nonce:um_scripts.nonce},success:function(e){void 0!==e.restricted&&(alert(e.restricted),window.location.reload()),void 0!==e.debug&&console.log(e.debug)}})}return!1}),jQuery(document).on("click",".um-groups-comment-like.active",function(e){e.preventDefault();var t=jQuery(this).parents(".um-groups-commentl").attr("id").replace("commentid-",""),o=jQuery(this).parents(".um-groups-commentl").find(".um-groups-ajaxdata-commentlikes"),r=parseInt(o.html())-1;return o.html(r),jQuery(this).parents(".um-groups-commentl").find(".um-groups-comment-likes").removeClass().addClass("um-groups-comment-likes").addClass("count-"+r),jQuery(this).removeClass("active"),jQuery(this).html(jQuery(this).attr("data-like_text")),jQuery.ajax({url:wp.ajax.settings.url,type:"post",dataType:"json",data:{action:"um_groups_unlike_comment",commentid:t,group_id:jQuery('input[name="group_id"]').val(),nonce:um_scripts.nonce},success:function(e){void 0!==e.restricted&&(alert(e.restricted),window.location.reload()),void 0!==e.debug&&console.log(e.debug)}}),!1}),jQuery(document).on("click",".um-groups-like:not(.active) a",function(e){if(e.preventDefault(),!jQuery(this).parents(".um-groups-widget").hasClass("unready")){var t=jQuery(this).parents(".um-groups-widget").attr("id").replace("postid-","");jQuery(this).find("i").addClass("um-effect-pop"),jQuery(this).parent().addClass("active"),jQuery(this).find("span").html(jQuery(this).parent().attr("data-unlike_text")),jQuery(this).find("i").addClass("um-active-color");var o=jQuery(this).parents(".um-groups-widget").find(".um-groups-post-likes");o.html(parseInt(o.html())+1),jQuery.ajax({url:wp.ajax.settings.url,type:"post",dataType:"json",data:{action:"um_groups_like_post",postid:t,group_id:jQuery('input[name="group_id"]').val(),nonce:um_scripts.nonce},success:function(e){void 0!==e.restricted&&(alert(e.restricted),window.location.reload()),void 0!==e.debug&&console.log(e.debug)}})}return!1}),jQuery(document).on("click",".um-groups-like.active a",function(e){e.preventDefault();var t=jQuery(this).parents(".um-groups-widget").attr("id").replace("postid-","");jQuery(this).find("i").removeClass("um-effect-pop"),jQuery(this).parent().removeClass("active"),jQuery(this).find("span").html(jQuery(this).parent().attr("data-like_text")),jQuery(this).find("i").removeClass("um-active-color");var o=jQuery(this).parents(".um-groups-widget").find(".um-groups-post-likes");return o.html(parseInt(o.html())-1),jQuery.ajax({url:wp.ajax.settings.url,type:"post",dataType:"json",data:{action:"um_groups_unlike_post",postid:t,group_id:jQuery('input[name="group_id"]').val(),nonce:um_scripts.nonce},success:function(e){void 0!==e.restricted&&(alert(e.restricted),window.location.reload()),void 0!==e.debug&&console.log(e.debug)}}),!1}),jQuery(document).on("click",".um-groups-manage, .um-groups-edit-cancel",function(e){e.preventDefault();var t=jQuery(this),o=t.parents(".um-groups-widget").attr("id").replace("postid-","");if(jQuery(this).parents(".um-groups-dialog").length&&jQuery(this).parents(".um-groups-dialog").hide(),0<t.parents(".um-groups-widget").find("form").length)t.parents(".um-groups-widget").find(".um-groups-bodyinner-txt").show(),t.parents(".um-groups-widget").find(".um-groups-bodyinner-photo").show(),t.parents(".um-groups-widget").find(".um-groups-bodyinner-video").show(),t.parents(".um-groups-widget").find("form").remove();else{var r=jQuery(".um-groups-new-post form").clone();if(r.appendTo(t.parents(".um-groups-widget").find(".um-groups-bodyinner-edit")),r.find("textarea:visible").val(t.parents(".um-groups-widget").find(".um-groups-bodyinner-edit").find("textarea:hidden").val()).focus(),t.parents(".um-groups-widget").find(".um-groups-bodyinner-edit").find("#_photo_").val()){r.find(".um-groups-preview").show(),t.parents(".um-groups-widget").find(".um-groups-bodyinner-edit").find("#_photo_url").val()?(r.find(".um-groups-preview img").attr("src",t.parents(".um-groups-widget").find(".um-groups-bodyinner-edit").find("#_photo_url").val()),r.find(".um-groups-preview input[type=hidden]").val(t.parents(".um-groups-widget").find(".um-groups-bodyinner-edit").find("#_photo_url").val())):(r.find(".um-groups-preview img").attr("src",t.parents(".um-groups-widget").find(".um-groups-bodyinner-edit").find("#_photo_").val()),r.find(".um-groups-preview input[type=hidden]").val(t.parents(".um-groups-widget").find(".um-groups-bodyinner-edit").find("#_photo_").val()));var u=t.parents(".um-groups-widget").find(".um-groups-bodyinner-edit").find("#_photo_").clone(),n=t.parents(".um-groups-widget").find(".um-groups-bodyinner-edit").find("#_photo_url").clone();u.appendTo(t.parents(".um-groups-widget").find(".um-groups-bodyinner-edit")),n.appendTo(t.parents(".um-groups-widget").find(".um-groups-bodyinner-edit"))}r.find(".um-groups-post").html(t.attr("data-update_text")),r.find(".um-groups-post").before('<a href="#" class="um-groups-edit-cancel">'+t.attr("data-cancel_text")+"</a>"),r.find("#_post_id").val(o),t.parents(".um-groups-widget").find(".um-groups-bodyinner-txt").hide(),t.parents(".um-groups-widget").find(".um-groups-bodyinner-photo").hide(),t.parents(".um-groups-widget").find(".um-groups-bodyinner-video").hide(),UM_wall_img_upload(),UM_wall_autocomplete_start()}return jQuery("textarea.um-groups-textarea-elem").autoResize(),!1}),jQuery(document).on("submit",".um-groups-publish",function(e){e.preventDefault();var t=jQuery(this);if(0==t.find("textarea").val().trim().length&&0==t.find("#_post_img").val().trim().length)t.find("textarea").focus();else{if(jQuery(".um-groups-post").addClass("um-disabled"),formdata=t.serialize(),formdata_array=function(e){for(var t={},o=0;o<e.length;o++)t[e[o].name]=e[o].value;return t}(t.serializeArray()),0==t.find("#_post_id").val()){var o=t.parents(".um").find(".um-groups-wall"),r=o.find(".um-groups-clone:first").clone();r.prependTo(o).addClass("unready").fadeIn().find(".um-groups-bodyinner-txt").text(t.find("textarea").val()),0<t.find("#_post_img").val().trim().length&&(0==r.find(".um-groups-bodyinner-txt").html().trim().length&&r.find(".um-groups-bodyinner-txt").hide(),r.prependTo(o).find(".um-groups-bodyinner-photo").html('<a href="#" class="um-photo-modal" data-src="'+t.find("#_post_img").val()+'"><img src="'+t.find("#_post_img_url").val()+'" alt="" /></a>')),t.find("textarea").val("").height("auto"),t.find("#_post_img").val(""),t.find(".um-groups-preview").hide(),jQuery(".um-groups-textarea-elem").attr("placeholder",jQuery(".um-groups-textarea-elem").attr("data-ph"))}else t.css({opacity:.5});jQuery.ajax({url:wp.ajax.settings.url,type:"post",dataType:"json",data:formdata,success:function(e){0==t.find("#_post_id").val()?(t.find(".um-groups-preview").find("img").attr("src",""),r.removeClass("unready").attr("id","postid-"+e.postid).removeClass("um-groups-clone"),r.find(".um-groups-comment-textarea").show(),e.orig_content?r.find(".um-groups-bodyinner-edit textarea").val(e.orig_content):r.find(".um-groups-bodyinner-edit textarea").val(""),e.content?r.find(".um-groups-bodyinner-txt").html(e.content):r.find(".um-groups-bodyinner-txt").empty().hide(),e.link&&(r.find(".um-groups-bodyinner-txt").find(".post-meta").length?r.find(".um-groups-bodyinner-txt").show().find(".post-meta").replaceWith(e.link):r.find(".um-groups-bodyinner-txt").show().append(e.link)),e.photo?(r.find(".um-groups-bodyinner-edit input#_photo_").val(e.photo_base),r.find(".um-groups-bodyinner-edit input#_photo_url").val(e.photo),r.find(".um-groups-bodyinner-photo").find("a").attr("data-src",e.photo),r.find(".um-groups-bodyinner-photo").find("a").attr("href",e.photo),r.find(".um-groups-bodyinner-photo").find("img").attr("src",e.photo)):r.find(".um-groups-bodyinner-edit input#_photo_").val(""),e.video&&r.find(".um-groups-bodyinner-video").html(e.video),r.find(".um-groups-metadata a").attr("href",e.permalink),jQuery(r.find(".um-groups-comment-textarea")).autoResize()):(elem=t.parents(".um-groups-widget"),elem.find("form").remove(),e.orig_content?elem.find(".um-groups-bodyinner-edit textarea").val(e.orig_content):elem.find(".um-groups-bodyinner-edit textarea").val(""),e.content?(elem.find(".um-groups-bodyinner-txt").html(e.content),elem.find(".um-groups-bodyinner-txt").show()):elem.find(".um-groups-bodyinner-txt").empty().hide(),e.link&&(elem.find(".um-groups-bodyinner-txt").find(".post-meta").length?elem.find(".um-groups-bodyinner-txt").show().find(".post-meta").replaceWith(e.link):elem.find(".um-groups-bodyinner-txt").show().append(e.link)),e.photo?(elem.find(".um-groups-bodyinner-edit input#_photo_").val(e.photo_base),elem.find(".um-groups-bodyinner-edit input#_photo_url").val(e.photo),0==elem.find(".um-groups-bodyinner-photo").find("a").length?elem.find(".um-groups-bodyinner-photo").html('<a href="'+e.photo+'"><img src="'+e.photo+'" alt="" /></a>'):(elem.find(".um-groups-bodyinner-photo").find("a").attr("href",e.photo),elem.find(".um-groups-bodyinner-photo").find("img").attr("src",e.photo)),elem.find(".um-groups-bodyinner-photo").show()):(elem.find(".um-groups-bodyinner-edit input#_photo_").val(""),elem.find(".um-groups-bodyinner-photo").empty().hide()),e.video?(elem.find(".um-groups-bodyinner-video").html(e.video),elem.find(".um-groups-bodyinner-video").show()):elem.find(".um-groups-bodyinner-video").empty().hide()),UM_wall_autocomplete_start()}})}return!1}),jQuery(document).on("click",".um-groups-seemore a",function(e){return e.preventDefault(),p=jQuery(this).parents(".um-groups-bodyinner-txt"),p.find(".um-groups-seemore").remove(),p.find(".um-groups-hiddentext").show(),!1}),jQuery(".um-groups-widget:not(.um-groups-clone) .um-groups-comment-textarea").autoResize(),jQuery(".um-groups-textarea-elem").autoResize(),jQuery(document).on("click",".um-groups-post-approval-tool",function(){var t=jQuery(this),e=jQuery(this).attr("data-role"),o=jQuery(this).attr("data-uid"),r=jQuery('input[name="group_id"]').val(),u=jQuery(this).attr("data-discussion-id"),n=t.attr("data-msg");"delete"==e?(UM_wall_confirmbox_show(u,n,"um-groups-confirm-removepost"),UM_wall_confirmbox_mobile()):jQuery.ajax({method:"POST",url:wp.ajax.settings.url,type:"post",data:{action:"um_groups_approve_discussion_post",group_id:r,user_id:o,action:e,post_id:u,nonce:um_scripts.nonce}}).done(function(e){"deleted"!=e.status&&"approved"!=e.status||t.parents("div[class=um-groups-widget]").remove(),t.parents("div[class=um-groups-wall]").find("div[class=um-groups-widget]:not(.um-groups-clone)").length<=0&&jQuery("ul.um-groups-single-tabs li:first a").trigger("click")})}),jQuery("ul.um-groups-single-tabs li:first a").on("click",function(){window.location.href=jQuery(this).attr("href")})});